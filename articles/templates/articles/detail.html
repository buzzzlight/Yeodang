{% extends 'base.html' %}
{% load django_bootstrap5 %}

{% block content %} 
<h1>{{ article.title }}</h1>
<p>{{ article.pk }}번 게시글</p>
<p> {{ article.update_counter }}</p>
<p>{{ article.created_at|date:"SHORT_DATETIME_FORMAT" }} | {{ article.updated_at|date:"y-m-d D" }}</p>


{% if request.user == article.user %}
<p>
  <a href="{% url 'articles:update' article.pk %}">수정하기</a>
</p>
{% endif %}
<hr>
<p>{{ article.content }} </p>
{% if article.image %}
<div class="card" style="width: 18rem;">
  <div class="card-header">
    <div id="post_{{ post.id }}" class="carousel slide" data-ride="carousel">
      <div class="carousel-inner">
        {% for photo in article.photo_set.all %}
        {% if photo.image %}
        <div class="carousel-item {% if forloop.counter == 1 %} active {% endif %}">
          <img src="{{photo.image.url}}" width="250px">
        </div>
        {% endif %}
        {% endfor %}
      
      </div>
      <a class="carousel-control-prev" href="#article_{{ article.id }}" 
         role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" href="#article_{{ article.id }}" 
         role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>
   
  </div> 
  <span> <a href="{% url 'accounts:detail' article.user.pk %}">{{ article.user.username }}</a></span>
  <p>{{ article.title }}</p>
  <p>{{ article.content }} </p>
  <span>{% if request.user.is_authenticated %}
    <button type="button" class="btn btn-primary"><a class="text-white text-decoration-none" href="{% url 'articles:like' article.pk %}">❤</a> <span>{{ article.like_users.count }}</span></button>
    {% else %}
    <button type="button" class="btn btn-danger me-2 disabled">로그인 필요</button><button type="button" class="btn btn-primary" disabled>❤ <span>{{ article.like_users.count }}</button>
    {% endif %}</span>

<hr>
<h4 class="my-3">댓글</h4>
{% if request.user.is_authenticated %}
<form action="{% url 'articles:comment_create' article.pk %}" method="POST">
  {% csrf_token %}
  {% bootstrap_form comment_form layout='floating'%}
  {% bootstrap_button button_type="submit" content="OK" %}
</form>
{% endif %}

{% for comment in comments %}
  <p> {{ comment.user.username }} | {{ comment.content }}</p>
  <hr>    
{% endfor %}
{% endblock content %}
